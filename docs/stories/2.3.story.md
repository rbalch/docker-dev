# Story 2.3: Create Basic Agent Engine Deployment Script

**Status:** Draft

**Story**
**As a** developer using the ADK,
**I want** a simple command to deploy the sample agent,
**so that** I can quickly test the full development-to-deployment lifecycle.

**Acceptance Criteria**
1. The sample agent is appropriately wrapped in an `AdkApp` object for deployment.
2. A `Makefile` command (`make deploy-agent-engine`) is created.
3. The command uses the `adk` CLI or the Vertex AI SDK to deploy the `AdkApp` to Agent Engine.
4. The script prompts for necessary GCP configuration (Project ID, Region) if not already set as environment variables.

**Tasks / Subtasks**
- [ ] **Task 1: Make Agent Deployable (AC: 1)**
  - [ ] Modify the sample agent file in `template/adk/agents/` to ensure the agent logic is wrapped in an `AdkApp` object, making it a deployable application.
- [ ] **Task 2: Create Deployment Script (AC: 4)**
  - [ ] Create a new helper script, e.g., `template/scripts/deploy.py`.
  - [ ] This script will be responsible for checking for `GCP_PROJECT_ID` and `GCP_REGION` environment variables.
  - [ ] If the variables are not set, the script must interactively prompt the user for them.
  - [ ] Once configuration is confirmed, the script will execute the deployment command.
- [ ] **Task 3: Add Makefile Command (AC: 2, 3)**
  - [ ] Modify the `Makefile.template` to add a new target: `deploy-agent-engine`.
  - [ ] The command for this target should execute the helper script, e.g., `poetry run python template/scripts/deploy.py`.
- [ ] **Task 4: Implement Deployment Logic (AC: 3)**
  - [ ] Within `deploy.py`, add the command to deploy the agent using the `adk` CLI. The command will likely be `adk deploy <path_to_sample_agent> --project <project_id> --region <region>`.
- [ ] **Task 5: Testing (AC: 2, 4)**
  - [ ] Add a unit test for the `deploy.py` script to verify that it correctly checks for environment variables and prompts the user when they are missing. [Source: docs/architecture/16-testing-strategy.md]
  - [ ] Manually test the `make deploy-agent-engine` command to confirm the deployment flow (mocking the actual `adk` call may be necessary).

**Dev Notes**
This story is part of **Epic 2: Foundational ADK Integration & Deployment**.

- **File Locations**:
  - The sample agent in `template/adk/agents/` will be modified.
  - A new deployment script should be created, e.g., `template/scripts/deploy.py`.
  - The `Makefile.template` will be modified to add the new command.
- **Configuration**:
  - The deployment script needs to handle GCP configuration (`GCP_PROJECT_ID`, `GCP_REGION`), sourcing from environment variables first, then prompting the user.
- **External Tools**:
  - The deployment will rely on the `adk` CLI, which is expected to be available in the container's environment. [Source: docs/architecture/3-tech-stack.md]

**Change Log**
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-09-11 | 1.0 | Initial draft | Bob (SM) |
| 2025-09-11 | 1.1 | Generalized agent filename. | Bob (SM) |

# Story 2.2: Implement ADK Scaffolding in Installer

**Status:** Done

**Story**
**As a** developer setting up a new project,
**I want** the installer to ask about including Google ADK support,
**so that** I can optionally add agent development tools to my environment from the start.

**Acceptance Criteria**
1. The interactive installer includes a prompt asking the user if they want to add Google ADK support.
2. The `npx` command accepts an `--adk-setup` flag to enable this non-interactively.
3. If the user agrees (or if the flag is present), the tool copies the entire `template/adk` directory to the root of the generated project.

**Tasks / Subtasks**
- [x] **Task 1: Update Scaffolding Config (AC: 1, 2)**
  - [x] Modify the `ScaffoldingConfig` interface in `src/types.ts` (or equivalent) to include a new boolean property, e.g., `adkSupport: boolean`. [Source: docs/architecture/4-data-models-revised.md]
- [x] **Task 2: Add Interactive Prompt (AC: 1)**
  - [x] Modify `src/prompts.ts` to add a new `confirm` prompt asking the user if they want to include ADK support. [Source: docs/architecture/10-frontend-architecture-cli.md]
  - [x] Ensure the result of this prompt updates the `adkSupport` property in the config object.
- [x] **Task 3: Add CLI Flag (AC: 2)**
  - [x] Modify the CLI entry point (`src/index.ts`) to accept an `--adk-setup` flag.
  - [x] If the flag is present, set the `adkSupport` property in the config object to `true`, bypassing the interactive prompt.
- [x] **Task 4: Update File Generator (AC: 3)**
  - [x] Modify the `src/generator.ts` module.
  - [x] Add logic to conditionally execute based on the `adkSupport` flag in the config.
  - [x] If `adkSupport` is true, the generator must copy the entire `template/adk` directory to the project root destination (`config.installPath`).
- [x] **Task 5: Testing (AC: 1, 2, 3)**
  - [x] Add a unit test for the new prompt in `prompts.ts`. [Source: docs/architecture/16-testing-strategy.md]
  - [x] Add/update integration tests to verify the `--adk-setup` flag works correctly.
  - [x] Add/update E2E tests to simulate non-interactive flows, asserting that an `adk/` directory and its contents exist in the generated project root only when requested. [Source: docs/architecture/16-testing-strategy.md]

**Dev Notes**
This story is part of **Epic 2: Foundational ADK Integration & Deployment**.

- **File Locations**:
  - All modifications will be within the `src/` directory, primarily `prompts.ts`, `generator.ts`, and the main CLI entry point.
  - The generator will copy the existing `template/adk` directory to the project root.
  - [Source: docs/architecture/10-frontend-architecture-cli.md, docs/architecture/12-unified-project-structure.md]
- **Data Models**:
  - The `ScaffoldingConfig` interface will need to be extended to track the user's choice regarding ADK support. [Source: docs/architecture/4-data-models-revised.md]
- **Testing**:
  - Per the testing strategy, the new interactive prompt requires a corresponding CLI flag (`--adk-setup`) for testability. This is explicitly included in the AC. [Source: docs/architecture/16-testing-strategy.md]

**Dev Agent Record**

**Completion Notes**
- Added `adkSupport` option to the scaffolding config, interactive prompts, and CLI flags.
- The generator now copies the `template/adk` directory when `adkSupport` is true.
- Added unit and E2E tests to verify the new functionality.

**File List**
- `src/config.ts`
- `src/prompts.ts`
- `src/index.ts`
- `src/generator.ts`
- `tests/unit/prompts.test.ts`
- `tests/unit/generator.test.ts`
- `tests/e2e/greenfield.bats`

**Change Log**
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-09-12 | 1.2 | Implemented ADK scaffolding | James (dev) |
| 2025-09-11 | 1.1 | Corrected generator logic to copy from `template/` dir. | Bob (SM) |
| 2025-09-11 | 1.0 | Initial draft | Bob (SM) |

## QA Results

### Review Date: 2025-09-12

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

The implementation is clean, follows existing project patterns, and effectively isolates the new functionality. No immediate refactoring is required.

### Refactoring Performed

None. The code submitted was of high quality.

### Compliance Check

- Coding Standards: [✓]
- Project Structure: [✓]
- Testing Strategy: [✓]
- All ACs Met: [✓]

### Improvements Checklist

- [✓] All required functionality is implemented and tested.

### Security Review

No security concerns were identified. The changes involve adding optional scaffolding files and do not handle user data or introduce new runtime dependencies.

### Performance Considerations

No performance impact. The changes only affect the project generation process.

### Files Modified During Review

None.

### Gate Status

Gate: PASS → docs/qa/gates/2.2-implement-adk-scaffolding-in-installer.yml

### Recommended Status

[✓ Ready for Done]